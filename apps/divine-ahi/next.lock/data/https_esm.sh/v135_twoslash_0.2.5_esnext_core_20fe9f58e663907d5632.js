/* esm.sh - esbuild bundle(twoslash@0.2.5/core) esnext production */
import { Buffer as __Buffer$ } from "/v135/buffer@6.0.3/esnext/buffer.bundle.mjs";
import{createSystem as je,createFSBackedSystem as Ie,createVirtualTypeScriptEnvironment as fe}from"/v135/@typescript/vfs@1.5.0/esnext/vfs.mjs";import{createPositionConverter as ue,isInRange as pe,removeCodeRanges as he,resolveNodePositions as Ne,isInRanges as Me}from"/v135/twoslash-protocol@0.2.5/esnext/twoslash-protocol.mjs";import{removeCodeRanges as we}from"/v135/twoslash-protocol@0.2.5/esnext/twoslash-protocol.mjs";var xe=Object.defineProperty,be=(n,r,a)=>r in n?xe(n,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[r]=a,N=(n,r,a)=>(be(n,typeof r!="symbol"?r+"":r,a),a),b=class extends Error{constructor(r,a,o,e){let i=`
## ${r}

${a}
`;o&&(i+=`
${o}`),e&&(i+=`
${e}`),super(i),N(this,"title"),N(this,"description"),N(this,"recommendation"),N(this,"code"),this.title=r,this.description=a,this.recommendation=o,this.code=e}},ee={strict:!0,module:99,target:99,allowJs:!0,skipDefaultLibCheck:!0,skipLibCheck:!0,moduleDetection:3},_={errors:[],noErrors:!1,noErrorsCutted:!1,noErrorValidation:!1,noStaticSemanticInfo:!1,showEmit:!1,showEmittedFile:void 0,keepNotations:!1},G=Object.freeze({ignoreUnknown:!1,respectType:!1,respectFunctionNames:!1,respectFunctionProperties:!1,unorderedObjects:!0,unorderedArrays:!1,unorderedSets:!1,excludeKeys:void 0,excludeValues:void 0,replacer:void 0});function ke(n,r){r?r={...G,...r}:r=G;let a=te(r);return a.dispatch(n),a.toString()}var ve=Object.freeze(["prototype","__proto__","constructor"]);function te(n){let r="",a=new Map,o=e=>{r+=e};return{toString(){return r},getContext(){return a},dispatch(e){return n.replacer&&(e=n.replacer(e)),this[e===null?"null":typeof e](e)},object(e){if(e&&typeof e.toJSON=="function")return this.object(e.toJSON());let i=Object.prototype.toString.call(e),l="",c=i.length;c<10?l="unknown:["+i+"]":l=i.slice(8,c-1),l=l.toLowerCase();let u=null;if((u=a.get(e))===void 0)a.set(e,a.size);else return this.dispatch("[CIRCULAR:"+u+"]");if(typeof __Buffer$<"u"&&__Buffer$.isBuffer&&__Buffer$.isBuffer(e))return o("buffer:"),o(e.toString("utf8"));if(l!=="object"&&l!=="function"&&l!=="asyncfunction")this[l]?this[l](e):n.ignoreUnknown||this.unkown(e,l);else{let h=Object.keys(e);n.unorderedObjects&&(h=h.sort());let y=[];n.respectType!==!1&&!W(e)&&(y=ve),n.excludeKeys&&(h=h.filter(x=>!n.excludeKeys(x)),y=y.filter(x=>!n.excludeKeys(x))),o("object:"+(h.length+y.length)+":");let d=x=>{this.dispatch(x),o(":"),n.excludeValues||this.dispatch(e[x]),o(",")};for(let x of h)d(x);for(let x of y)d(x)}},array(e,i){if(i=i===void 0?n.unorderedArrays!==!1:i,o("array:"+e.length+":"),!i||e.length<=1){for(let u of e)this.dispatch(u);return}let l=new Map,c=e.map(u=>{let h=te(n);h.dispatch(u);for(let[y,d]of h.getContext())l.set(y,d);return h.toString()});return a=l,c.sort(),this.array(c,!1)},date(e){return o("date:"+e.toJSON())},symbol(e){return o("symbol:"+e.toString())},unkown(e,i){if(o(i),!!e&&(o(":"),e&&typeof e.entries=="function"))return this.array(Array.from(e.entries()),!0)},error(e){return o("error:"+e.toString())},boolean(e){return o("bool:"+e)},string(e){o("string:"+e.length+":"),o(e)},function(e){o("fn:"),W(e)?this.dispatch("[native]"):this.dispatch(e.toString()),n.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(e.name)),n.respectFunctionProperties&&this.object(e)},number(e){return o("number:"+e)},xml(e){return o("xml:"+e.toString())},null(){return o("Null")},undefined(){return o("Undefined")},regexp(e){return o("regex:"+e.toString())},uint8array(e){return o("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},uint8clampedarray(e){return o("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(e))},int8array(e){return o("int8array:"),this.dispatch(Array.prototype.slice.call(e))},uint16array(e){return o("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},int16array(e){return o("int16array:"),this.dispatch(Array.prototype.slice.call(e))},uint32array(e){return o("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},int32array(e){return o("int32array:"),this.dispatch(Array.prototype.slice.call(e))},float32array(e){return o("float32array:"),this.dispatch(Array.prototype.slice.call(e))},float64array(e){return o("float64array:"),this.dispatch(Array.prototype.slice.call(e))},arraybuffer(e){return o("arraybuffer:"),this.dispatch(new Uint8Array(e))},url(e){return o("url:"+e.toString())},map(e){o("map:");let i=[...e];return this.array(i,n.unorderedSets!==!1)},set(e){o("set:");let i=[...e];return this.array(i,n.unorderedSets!==!1)},file(e){return o("file:"),this.dispatch([e.name,e.size,e.type,e.lastModfied])},blob(){if(n.ignoreUnknown)return o("[blob]");throw new Error(`Hashing Blob objects is currently not supported
Use "options.replacer" or "options.ignoreUnknown"
`)},domwindow(){return o("domwindow")},bigint(e){return o("bigint:"+e.toString())},process(){return o("process")},timer(){return o("timer")},pipe(){return o("pipe")},tcp(){return o("tcp")},udp(){return o("udp")},tty(){return o("tty")},statwatcher(){return o("statwatcher")},securecontext(){return o("securecontext")},connection(){return o("connection")},zlib(){return o("zlib")},context(){return o("context")},nodescript(){return o("nodescript")},httpparser(){return o("httpparser")},dataview(){return o("dataview")},signal(){return o("signal")},fsevent(){return o("fsevent")},tlswrap(){return o("tlswrap")}}}var ne="[native code] }",Fe=ne.length;function W(n){return typeof n!="function"?!1:Function.prototype.toString.call(n).slice(-Fe)===ne}var oe=/^\/\/\s?@(\w+)$/mg,re=/^\/\/\s?@(\w+):\s?(.+)$/mg,se=/^\s*\/\/\s*\^(\?|\||\^+)( .*)?$/mg,Se=/^\/\/\s?---cut(-before)?---\r?\n/mg,Ee=/^\/\/\s?---cut-after---$/mg,Ce=/^\/\/\s?---cut-start---$/mg,Te=/^\/\/\s?---cut-end---\r?\n/mg;function ie(n){return ke(n)}function Y(n,r){if(typeof n===r)return n;switch(r){case"number":return+n;case"string":return n;case"boolean":return n.toLowerCase()==="true"||n.length===0}throw new b("Unknown primitive value in compiler flag",`The only recognized primitives are number, string and boolean. Got ${r} with ${n}.`,"This is likely a typo.")}function H(n){let r={js:"js",javascript:"js",ts:"ts",typescript:"ts",tsx:"tsx",jsx:"jsx",json:"json",jsn:"json",map:"json",mts:"ts",cts:"ts",mjs:"js",cjs:"js"};if(r[n])return r[n];throw new b("Unknown TypeScript extension given to Twoslash",`Received ${n} but Twoslash only accepts: ${Object.keys(r)} `,"")}function ae(n,r,a){let o=[];return e(r),o;function e(i){n.forEachChild(i,l=>{if(n.isIdentifier(l)){let c=l.getText(r),u=l.getStart(r,!1)+a,h=u+c.length;o.push([u,h,c])}e(l)})}}function X(n,r,a){let o=a.get(r.toLowerCase());if(o===void 0){let e=Array.from(a.keys());throw new b("Invalid inline compiler value",`Got ${r} for ${n} but it is not a supported value by the TS compiler.`,`Allowed values: ${e.join(",")}`)}return o}var Oe=/^\/\/\s?@filename: (.+)$/mg;function V(n,r,a){let o=Array.from(n.matchAll(Oe)),i=o.map(u=>u[1].trimEnd()).includes(r)?"__index__.ts":r,l=[],c=0;for(let u of o){let h=u.index,y=n.slice(c,h);y&&l.push({offset:c,filename:i,filepath:a+i,content:y,extension:M(i)}),i=u[1].trimEnd(),c=h}if(c<n.length){let u=n.slice(c);l.push({offset:c,filename:i,filepath:a+i,content:u,extension:M(i)})}return l}function M(n){return n.split(".").pop()}function Z(n,r,a,o,e,i){if(e.includes(n))return{type:"tag",name:n,value:r,start:a,end:o};let l=i.find(c=>c.name.toLocaleLowerCase()===n.toLocaleLowerCase());if(l)switch(l.type){case"number":case"string":case"boolean":return{type:"compilerOptions",name:l.name,value:Y(r,l.type),start:a,end:o};case"list":{let c=l.element.type,u=r.split(","),h=typeof c=="string"?u.map(y=>Y(y,c)):u.map(y=>X(l.name,y,c));return{type:"compilerOptions",name:l.name,value:h,start:a,end:o}}case"object":return{type:"compilerOptions",name:l.name,value:JSON.parse(r),start:a,end:o};default:return{type:"compilerOptions",name:l.name,value:X(l.name,r,l.type),start:a,end:o}}return Object.keys(_).includes(n)?(n==="errors"&&typeof r=="string"&&(r=r.split(" ").map(Number)),n==="noErrors"&&typeof r=="string"&&(r==="true"?r=!0:r==="false"?r=!1:r=r.split(" ").map(Number)),{type:"handbookOptions",name:n,value:r,start:a,end:o}):{type:"unknown",name:n,value:r,start:a,end:o}}function le(n,r,a){let o=[];return Array.from(n.matchAll(oe)).forEach(e=>{let i=e.index,l=e[1];o.push(Z(l,!0,i,i+e[0].length+1,r,a))}),Array.from(n.matchAll(re)).forEach(e=>{let i=e[1];if(i==="filename")return;let l=e.index,c=e[2];o.push(Z(i,c,l,l+e[0].length+1,r,a))}),o}function B(n,r){let a=[],o=[...n.matchAll(Se)],e=[...n.matchAll(Ee)],i=[...n.matchAll(Ce)],l=[...n.matchAll(Te)];if(o.length){let c=o[o.length-1];a.push([0,c.index+c[0].length])}if(e.length){let c=e[0];a.push([c.index,n.length])}if(i.length!==l.length)throw new b("Mismatched cut markers",`You have ${i.length} cut-starts and ${l.length} cut-ends`,"Make sure you have a matching pair for each.");for(let c=0;c<i.length;c++){let u=i[c],h=l[c];if(u.index>h.index)throw new b("Mismatched cut markers",`You have a cut-start at ${u.index} which is after the cut-end at ${h.index}`,"Make sure you have a matching pair for each.");a.push([u.index,h.index+h[0].length])}return r&&r.removals.push(...a),a}function ce(n,r,a){if(n.includes("//")){let o=new Set;Array.from(n.matchAll(se)).forEach(e=>{let i=e[1],l=e.index;r.removals.push([l,l+e[0].length+1]);let c=e[0].indexOf("^"),u=a.indexToPos(l+c),h=u.line-1;for(;o.has(h)&&h>=0;)h-=1;let y=a.posToIndex(h,u.character);if(i==="?")r.positionQueries.push(y);else if(i==="|")r.positionCompletions.push(y);else{let d=e[0].lastIndexOf("^")-c+1;r.positionHighlights.push([y,y+d,e[2]?.trim()])}o.add(u.line)})}return r}function J(n){return n.replace(/\.map$/,"").replace(/\.d\.ts$/,".ts").replace(/\.map$/,"").replace(/\.[^/.]+$/,"")}var $e=["all","allowArbitraryExtensions","allowImportingTsExtensions","allowJs","allowSyntheticDefaultImports","allowUmdGlobalAccess","allowUnreachableCode","allowUnusedLabels","alwaysStrict","assumeChangesOnlyAffectDirectDependencies","baseUrl","build","charset","checkJs","composite","customConditions","declaration","declarationDir","declarationMap","diagnostics","disableReferencedProjectLoad","disableSizeLimit","disableSolutionSearching","disableSourceOfProjectReferenceRedirect","downlevelIteration","emitBOM","emitDeclarationOnly","emitDecoratorMetadata","errors","esModuleInterop","exactOptionalPropertyTypes","experimentalDecorators","explainFiles","extendedDiagnostics","forceConsistentCasingInFileNames","generateCpuProfile","generateTrace","help","help","ignoreDeprecations","importHelpers","importsNotUsedAsValues","incremental","init","inlineSourceMap","inlineSources","isolatedModules","jsx","jsxFactory","jsxFragmentFactory","jsxImportSource","keepNotations","keyofStringsOnly","lib","listEmittedFiles","listFiles","listFilesOnly","locale","mapRoot","maxNodeModuleJsDepth","module","moduleDetection","moduleResolution","moduleSuffixes","newLine","noEmit","noEmitHelpers","noEmitOnError","noErrorTruncation","noErrorValidation","noErrors","noErrorsCutted","noFallthroughCasesInSwitch","noImplicitAny","noImplicitOverride","noImplicitReturns","noImplicitThis","noImplicitUseStrict","noLib","noPropertyAccessFromIndexSignature","noResolve","noStaticSemanticInfo","noStrictGenericChecks","noUncheckedIndexedAccess","noUnusedLocals","noUnusedParameters","out","outDir","outFile","paths","plugins","preserveConstEnums","preserveSymlinks","preserveValueImports","preserveWatchOutput","pretty","project","reactNamespace","removeComments","resolveJsonModule","resolvePackageJsonExports","resolvePackageJsonImports","rootDir","rootDirs","showConfig","showEmit","showEmittedFile","skipDefaultLibCheck","skipLibCheck","sourceMap","sourceRoot","strict","strictBindCallApply","strictFunctionTypes","strictNullChecks","strictPropertyInitialization","stripInternal","suppressExcessPropertyErrors","suppressImplicitAnyIndexErrors","target","traceResolution","tsBuildInfoFile","typeRoots","types","useDefineForClassFields","useUnknownInCatchVariables","verbatimModuleSyntax","version","watch"];function Ae(n,r){let a={removals:[]},o=[...r??[],...$e];return Array.from(n.matchAll(oe)).forEach(e=>{o.includes(e[1])&&a.removals.push([e.index,e.index+e[0].length+1])}),Array.from(n.matchAll(re)).forEach(e=>{o.includes(e[1])&&a.removals.push([e.index,e.index+e[0].length+1])}),B(n,a),Array.from(n.matchAll(se)).forEach(e=>{let i=e.index;a.removals.push([i,i+e[0].length+1])}),we(n,a.removals).code}export*from"/v135/twoslash-protocol@0.2.5/esnext/types.js";function Pe(n,r,a){let o=n.filter(i=>i.code&&!r.errors.includes(i.code)),e=Array.from(new Set(o.map(i=>i.code))).join(" ");if(o.length){let i=new Set(n.map(s=>s.code)),l=`// @errors: ${Array.from(i).join(" ")}`,c=r.errors.length?`
The existing annotation specified ${r.errors.join(" ")}`:`
Expected: ${l}`,u={},h=[];o.forEach(s=>{let E=s.filename?.replace(a,"");if(!E)h.push(s);else{let F=u[E];F?F.push(s):u[E]=[s]}});let y=(s,E)=>`${s}
  ${E.map(F=>`[${F.code}] ${F.start} - ${F.text}`).join(`
  `)}`,d=[];h.length&&d.push(y("Ambient Errors",h)),Object.keys(u).forEach(s=>{d.push(y(s,u[s]))});let x=d.join(`

`);throw new b("Errors were thrown in the sample, but not included in an error tag",`These errors were not marked as being expected: ${e}. ${c}`,`Compiler Errors:

${x}`)}}function Le(n={}){let r=n.tsModule,a=r.optionDeclarations,o=!!n.fsMap,e=n.vfsRoot.replace(/\\/g,"/"),i=n.fsMap||new Map,l=o?je(i):{...Ie(i,e,r,n.tsLibDirectory),realpath(d){return i.has(d)?d:r.sys.realpath?.(d)||d}},c=o?"/":`${e}/`,u=n.cache===!1?void 0:n.cache instanceof Map?n.cache:new Map;function h(d){if(!u)return fe(l,[],r,d,n.customTransformers);let x=ie(d);if(!u?.has(x)){let v=fe(l,[],r,d,n.customTransformers);return u?.set(x,v),v}return u.get(x)}function y(d,x="ts",v={}){let s={extension:H(x),compilerOptions:{...ee,baseUrl:c,...n.compilerOptions,...v.compilerOptions},handbookOptions:{..._,...n.handbookOptions,...v.handbookOptions},removals:[],flagNotations:[],virtualFiles:[],positionQueries:v.positionQueries||[],positionCompletions:v.positionCompletions||[],positionHighlights:v.positionHighlights||[]},{customTags:E=n.customTags||[],shouldGetHoverInfo:F=n.shouldGetHoverInfo||(()=>!0),filterNode:P=n.filterNode,extraFiles:L=n.extraFiles||{}}=v,K=`index.${s.extension}`,k=[],I=t=>t>=d.length||t<0||Me(t,s.removals,!1);s.flagNotations=le(d,E,a);for(let t of s.flagNotations){switch(t.type){case"unknown":continue;case"compilerOptions":s.compilerOptions[t.name]=t.value;break;case"handbookOptions":s.handbookOptions[t.name]=t.value;break;case"tag":k.push({type:"tag",name:t.name,start:t.end,length:0,text:t.value});break}s.removals.push([t.start,t.end])}if(!s.handbookOptions.noErrorValidation){let t=s.flagNotations.filter(f=>f.type==="unknown");if(t.length)throw new b("Unknown inline compiler flags",`The following flags are either valid TSConfig nor handbook options:
${t.map(f=>`@${f.name}`).join(", ")}`,"This is likely a typo, you can check all the compiler flags in the TSConfig reference, or check the additional Twoslash flags in the npm page for @typescript/twoslash.")}let S=h(s.compilerOptions),T=S.languageService,O=ue(d);B(d,s),ce(d,s,O);let de=["js","jsx","ts","tsx"];s.virtualFiles=V(d,K,c);let D=new Map;function R(t){if(!D.has(t.filename)){let f=S.getSourceFile(t.filepath);D.set(t.filename,ae(r,f,t.offset-(t.prepend?.length||0)))}return D.get(t.filename)}function z(t){return s.virtualFiles.find(f=>pe(t,[f.offset,f.offset+f.content.length]))}function Q(t,f,m){let p=T.getQuickInfoAtPosition(t.filepath,U(f,t));if(p&&p.displayParts){let g=p.displayParts.map(j=>j.text).join(""),w=p.documentation?.map(j=>j.text).join(`
`)||void 0,A=p.tags?.map(j=>[j.name,j.text?.map(ye=>ye.text).join("")]);return{type:"hover",text:g,docs:w,tags:A,start:f,length:m.length,target:m}}}Object.entries(L).forEach(([t,f])=>{s.virtualFiles.find(m=>m.filename===t)||S.createFile(c+t,typeof f=="string"?f:(f.prepend||"")+(f.append||""))});for(let t of s.virtualFiles)if(de.includes(t.extension)||t.extension==="json"&&s.compilerOptions.resolveJsonModule){t.supportLsp=!0;let f=L[t.filename];f&&typeof f!="string"&&(t.append=f.append,t.prepend=f.prepend),S.createFile(t.filepath,q(t)),R(t)}function U(t,f){return t-f.offset+(f.prepend?.length||0)}function q(t){return(t.prepend||"")+t.content+(t.append||"")}if(!s.handbookOptions.showEmit){for(let t of s.virtualFiles)if(t.supportLsp&&!s.handbookOptions.noStaticSemanticInfo){let f=R(t);for(let[m,p,g]of f){if(I(m)||!F(g,m,t.filename))continue;let w=Q(t,m,g);w&&k.push(w)}}for(let t of s.positionQueries){if(I(t))throw new b("Invalid quick info query",`The request on line ${O.indexToPos(t).line+2} for quickinfo via ^? is in a removal range.`,"This is likely that the positioning is off.");let f=z(t),p=R(f).find(w=>pe(t,w)),g;if(p&&(g=Q(f,p[0],p[2])),g)g.type="query",k.push(g);else{let w=O.indexToPos(t);throw new b("Invalid quick info query",`The request on line ${w.line+2} in ${f.filename} for quickinfo via ^? returned nothing from the compiler.`,"This is likely that the positioning is off.")}}for(let t of s.positionHighlights)k.push({type:"highlight",start:t[0],length:t[1]-t[0],text:t[2]});for(let t of s.positionCompletions){let f=z(t);if(I(t)||!f)throw new b("Invalid completion query",`The request on line ${O.indexToPos(t).line+2} for completions via ^| is in a removal range.`,"This is likely that the positioning is off.");let m=d.slice(0,t).match(/[$_\w]+$/)?.[0]||"";m=m.split(".").pop();let p=[];if(m)p=T.getCompletionsAtPosition(f.filepath,U(t,f)-1,{triggerKind:1,includeCompletionsForModuleExports:!1})?.entries??[],m=p[0]?.replacementSpan&&d.slice(p[0].replacementSpan.start,t)||m,p=p.filter(w=>w.name.startsWith(m));else if(m=d[t-1],m&&(p=T.getCompletionsAtPosition(f.filepath,U(t,f),{triggerKind:2,triggerCharacter:m,includeCompletionsForModuleExports:!1})?.entries??[],p[0]?.replacementSpan?.length)){m=d.slice(p[0].replacementSpan.start,t)||m;let w=p.filter(A=>A.name.startsWith(m));w.length&&(p=w)}if(!p?.length&&!s.handbookOptions.noErrorValidation){let g=O.indexToPos(t);throw new b("Invalid completion query",`The request on line ${g.line} in ${f.filename} for completions via ^| returned no completions from the compiler. (prefix: ${m})`,"This is likely that the positioning is off.")}k.push({type:"completion",start:t,length:0,completions:p,completionsPrefix:m})}}let $=[];for(let t of s.virtualFiles)if(t.supportLsp&&s.handbookOptions.noErrors!==!0){S.updateFile(t.filepath,q(t));let f=[...T.getSemanticDiagnostics(t.filepath),...T.getSyntacticDiagnostics(t.filepath)],m=Array.isArray(s.handbookOptions.noErrors)?s.handbookOptions.noErrors:[];for(let p of f){if(p.file?.fileName!==t.filepath||m.includes(p.code))continue;let g=p.start+t.offset-(t.prepend?.length||0);s.handbookOptions.noErrorsCutted&&I(g)||$.push({type:"error",start:g,length:p.length,code:p.code,filename:t.filename,id:`err-${p.code}-${g}-${p.length}`,text:r.flattenDiagnosticMessageText(p.messageText,`
`),level:De(p.category)})}}P&&(k=k.filter(P),$=$.filter(P)),k.push(...$),!s.handbookOptions.noErrorValidation&&$.length&&Pe($,s.handbookOptions,c);let C=d;if(s.handbookOptions.showEmit){if(s.handbookOptions.keepNotations)throw new b("Option 'showEmit' cannot be used with 'keepNotations'","With `showEmit` enabled, the output will always be the emitted code","Remove either option to continue");if(!s.handbookOptions.keepNotations){let{code:g}=he(C,s.removals),w=V(g,K,c);for(let A of w)S.updateFile(A.filepath,q(A))}let t=s.handbookOptions.showEmittedFile?s.handbookOptions.showEmittedFile:s.compilerOptions.jsx===1?"index.jsx":"index.js",f=s.virtualFiles.find(g=>J(g.filename)===J(t))?.filename;if(!f&&!s.compilerOptions.outFile){let g=s.virtualFiles.map(w=>w.filename).join(", ");throw new b("Could not find source file to show the emit for",`Cannot find the corresponding **source** file: '${t}'`,`Looked for: ${f} in the vfs - which contains: ${g}`)}s.compilerOptions.outFile&&(f=s.virtualFiles[0].filename);let m=T.getEmitOutput(c+f),p=m.outputFiles.find(g=>g.name===c+t||g.name===t);if(!p){let g=m.outputFiles.map(w=>w.name).join(", ");throw new b("Cannot find the output file in the Twoslash VFS",`Looking for ${t} in the Twoslash vfs after compiling`,`Looked for" ${c+t} in the vfs - which contains ${g}.`)}C=p.text,s.extension=H(M(p.name)),s.removals.length=0,k.length=0}if(!s.handbookOptions.keepNotations){let t=he(C,s.removals,k);C=t.code,k=t.nodes,s.removals=t.removals}let me=C===d?O.indexToPos:ue(C).indexToPos,ge=Ne(k,me);for(let t of s.virtualFiles)S.createFile(t.filepath,"");for(let t of Object.keys(L))S.createFile(c+t,"");return{code:C,nodes:ge,meta:s,get queries(){return this.nodes.filter(t=>t.type==="query")},get completions(){return this.nodes.filter(t=>t.type==="completion")},get errors(){return this.nodes.filter(t=>t.type==="error")},get highlights(){return this.nodes.filter(t=>t.type==="highlight")},get hovers(){return this.nodes.filter(t=>t.type==="hover")},get tags(){return this.nodes.filter(t=>t.type==="tag")}}}return y.getCacheMap=()=>u,y}function Ve(n,r,a){return Le({...a,cache:!1})(n,r)}function De(n){switch(n){case 0:return"warning";case 1:return"error";case 2:return"suggestion";case 3:return"message";default:return}}export{b as TwoslashError,Le as createTwoslasher,ee as defaultCompilerOptions,_ as defaultHandbookOptions,B as findCutNotations,le as findFlagNotations,ce as findQueryMarkers,ie as getObjectHash,Ae as removeTwoslashNotations,Ve as twoslasher,Pe as validateCodeForErrors};
//# sourceMappingURL=core.js.map