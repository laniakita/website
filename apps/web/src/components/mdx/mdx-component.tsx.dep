import { useMemo, type FC } from 'react';
import { getMDXComponent } from './mdx-bundler-components';
import { MDXProvider, useMDXComponents } from '@mdx-js/react';
import { globalMdxComponents } from './global-mdx-components';

const MDX_GLOBAL_CONFIG = {
  MdxJsReact: {
    useMDXComponents,
  },
};

// eslint-disable-next-line @typescript-eslint/no-explicit-any -- necessary
export const MDXComponent: FC<{ code: string; frontmatter?: Record<string, any> }> = ({ code }) => {
  const Component = useMemo(() => getMDXComponent(code, MDX_GLOBAL_CONFIG), [code]);
  return (
    // @ts-expect-error -- types okay
    <MDXProvider components={globalMdxComponents}>
      <Component />
    </MDXProvider>
  );
};